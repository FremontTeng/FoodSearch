List_dict ={'Canteen 1':
 ['0700-2100' #opening hrs
, 3 #ranking
, '455,418'#location
, ['Red/Green Campus Rider, Campus Weekend Rider, 179/179A, all alight at hall 1 bus-stop']#Miscelleanous Information
,{'Chicken Rice/Noodles': ['Non-Halal','Not vege',2.00,6.00,
                            ["Chicken rice","Chicken noodles"]
                            ]},
  
                  {'Beef Noodles': ['Non-Halal','Non-Veg',2.50,6.50,
                                    ['Beef Noodles']
                                    ]},
  
                  {'Western Cuisine': ['Non-Halal','Non-Veg',3.00,10.00,
                                       ['Fish and Chips','Chicken Chop']
                                       ]},
  
                  {'Mala Talk': ['Non-Halal','Non-Veg',2.00,10.00,
                                ["Mala"]
                                 ]},
  
                  {'Handmade Noodles': ['Non-Halal','Non-Veg',2.00,7.00,
                                        ["Fishball Noodles"]
                                        ]},
  
                  {'Chinese Cuisine': ['Non-Halal','Non-Veg',2.50,10.00,
                                        ["Fried Rice"]
                                       ]},
  
	      {'Economical Rice': ['Non-Halal','Non-Veg',1.50,7.00,
                                   ["Fried Rice"]
                                   ]},
  
	      {'Drinks Stall': ['Halal','Veg',2.50,10.00,
                                ["Watermelon"]
                                ]}


  ],


    'Canteen 2':
['0700-2100' #opening hrs
, 10 #ranking
, '450,400'#location
, ['Red/Green Campus Rider, Campus Weekend Rider, 179/179A, all alight at hall 1 bus-stop'#Miscelleanous Information
   ],
                 {'Kathy’s Bakery': ['Non-Halal','Non-Veg',0.50,3.00,["Hotdog"]]},
                  {'Japanese.Western': ['Halal','Non-Veg',3.50,8.00,["Chicken Bento Set"]]},
                  {'Ayam Penyet': ['Halal','Non-Veg',3.00,7.00,["Chicken Rice"]]},
                  {'Chicken Rice': ['Non-Halal','Non-Veg',2.00,6.00,["Chicken Rice"]]},
                  {'Xiao Long Bao': ['Non-Halal','Non-Veg',2.50,7.00,["Siew Mai"]]},
                  {'Korean Cuisine': ['Non-Halal','Non-Veg',2.50,8.50,["Kimchi Fried Rice"]]},
	      {'Yong Tau Foo': ['Non-Halal','Non-Veg',1.50,7.00,["Souped Rice"]]},
	      {'Sichuan Cuisine': ['Non-Halal','Non-Veg',2.50,5.00,["Beef Noodles"]]},
	      {'Shandong Big Bun': ['Non-Halal','Non-Veg',0.50,5.00,["Steamed Buns" ]]},
	      {'Economical Rice': ['Non-Halal','Non-Veg',1.50,7.00,["Mixed Veg Rice"]]},
	      {'Waffles': ['Non-Halal','Veg',1.00,4.00,["Australian Cream Waffle"]]},
                  {'La Kopi': ['Halal','Veg',1.00,5.00,["Teh O"]]}


 ],

'Pioneer Food Court': 
['0700-2100' #opening hrs
, 5 #ranking
, '300,278'#location
, ['Red/Green Campus Rider, Campus Weekend Rider, 179/179A, all alight at hall 1 bus-stop']#Miscelleanous Information
,
                 {'Thai Store': ['Non-Halal','Not-Veg',3.00,25.00,["Pineapple Fried Rice"]]},
                  {'Economic Rice/Bee Hoon': ['Non-Halal','Non-Veg',1.50,6.00,["Bee Hoon"]]},
                  {'Yong Tao Fu/Mini Wok': ['Non-Halal','Non-Veg',2.00,10.00,["Fish Soup"]]},
                  {'Korean Food': ['Halal','Non-Veg',3.50,10.00,["Raumen","Kimchi Fried Rice"]]},
                  {'Fruit Juice Stall': ['Halal','Veg',1.50,5.00,["Watermelon","Kiwi"]]},
	      {'Drinks Stall': ['Halal','Veg',2.50,5.00,["Lemon Tea","Teh O"]]},
                  {'Western Stall': ['Halal','Non-Veg',2.50,8.00,["Pasta","Spaghetti", "Chicken", "Pork", "Salad"]]}


  ],

     'Canteen North Hill': 


['0700-2200'
,1
,'756,233'
,['Blue Campus opp hall 11 bus-stop or Red Campus, 199 hall 11 bus-stop']
  ,
  {'Mix Rice':['Non-Halal','Non-Veg',2.40, 5.00,["Mixed Veg Rice"]]},
                        {'A&W Noodle': ['Non-Halal','Non-Veg',4.00, 5.00,["Spaghetti"]]},
                        {'Mala': ['Non-Halal','Not-Veg',4.00, 6.00,["Mala"]]},
                       {'YUM': ['Non-Halal','Non-Veg',4.5,7.0,["Fish and Chips"]]},
		{'Ah Boon Fish Soup': ['Halal','Non-Veg',4.0,5.5,765,233,["Fish Soup"]]}

],

    'Quad Cafe': 
['0700-2200'
,2
,'189,326'
,['Green Campus Rider/ Campus Weekend Rider alight at Administration Building OR Red Campus Rider/Campus Weekend Rider alight Outside School of Biological Sciences']
,
{'Mix Economic Rice': ['Non-Halal','Non-Veg',2.10, 4.00,["Mixed Veg Rice"]]},
{'Fruits and Beverages': ['Halal','Veg',1.20, 3.00,["Watermelon"]]},
{'Korea Food': ['Halal','Non-Veg',2.60, 6.50,["Cheesy Raumen"]]},
{'Chicken Rice': ['Halal','Non-Veg',2.80, 4.00,["Chicken Rice"]]},
{'Nasi Pandang': ['Halal','Non-Veg',3.00, 5.50,["Nasi Lemak"]]},
{'Fried Yong Tau Fu': ['Halal','Non-Veg',2.40, 4.00,["Yong Tau Fu"]]},
{'Anada Kitchen': ['Halal','Non-Veg',1.20, 6.50,["Prata"]]}

],


    'North Spine Food Court': 

[
'0700-2100'
,6
,'293,233'
,['Red Campus Rider/ Campus Weekend Rider, Bus 179, 179A alight Outside Canteen A & Lee Wee Nam Library / Opposite NIE OR Blue Campus Rider , Bus 199 alight Outside Canteen A & Lee Wee Nam Library / Outside NIE']
,
{'Italian Pasta': ['Non-Halal','Non-Veg',3.80, 7.00,["Fish and Chips","Tomato Pasta", "Chicken", "Fish", "Pork Chop"]]},
{'Vietnam Cuisine': ['Non-Halal','Non-Veg',4.20, 6.00,["Glass Noodles"]]},
{'BBQ Delight': ['Non-Halal','Non-Veg',4.50, 6.50,["Roasted Chicken"]]},
{'Japanese/Korean Delight': ['Non-Halal','Non-Veg',4.50, 7.00,["Bento Set"]]},
{'Claypot Rice': ['Non-Halal','Non-Veg',3.80, 7.50,["Chicken Claypot Rice"]]},
{'Fishball Noodles': ['Non-Halal','Non-Veg',2.90, 4.50,["Fish Ball Noodles"]]},
{'Roasted Duck': ['Non-Halal','Non-Veg',1.20, 6.50,["Prata"]]}

],

'Koufu': 

['0700-2100'
,7
,'198,434'
,['Red Campus Rider/ Campus Weekend Rider, Bus 179, 179A alight Outside Canteen A & Lee Wee Nam Library / Opposite NIE OR Blue Campus Rider , Bus 199 alight Outside Canteen A & Lee Wee Nam Library / Outside NIE']


    ,
    {'Indian Food': ['Halal','Non-Veg',3.00, 8.00,["Prata","Curry chicken"]]},
{'Yong Tau Fu': ['Non-Halal','Non-Veg',2.00, 7.00,["Yong Tau Fu"]]},
{'Chicken Rice Stall’': ['Non-Halal','Non-Veg',2.50, 6.50,["Roasted Chicken Rice, Steamed Chicken Rice"]]},
{'Pasta Stall': ['Non-Halal','Non-Veg',3.50, 7.00,["Pasta", "Spaghetti"]]},
{'Mixed Vegetables Rice': ['Non-Halal','Non-Veg',2.50, 8.50,["Mixed Vegetables Rice"]]},
{'Japanese Store': ['Non-Halal','Non-Veg',3.00, 6.00,["Udon", "Curry Chicken Cutlet", "Curry Pork Cutlet"]]},
{'Desserts Stall': ['Non-Halal','Non-Veg',1.20, 6.50,["Desserts"]]},
{'Beverages': ['Halal','Non-Veg',1.00, 5.00,["Drinks"]]},
{'Dim Sum': ['Non-Halal','Non-Veg',0.50, 3.00,["Steamed Buns", "Siew Mai", "Rice"]]},
{'Vegetarian Stall': ['Non-Halal','Veg',1.00, 6.50,["Vegetarian Rice"]]},
{'Salad Stall': ['Non-Halal','Veg',1.20, 5.00,["Salads"]]},
{'Rice Bowl Stall': ['Non-Halal','Non-Veg',1.00, 5.00,["Rice"]]}


],

'MacDonald’s': 

['0700-0000'
,4
,'198,434'
,['Red Campus Rider/ Campus Weekend Rider, Bus 179, 179A alight Outside Canteen A & Lee Wee Nam Library / Opposite NIE OR Blue Campus Rider , Bus 199 alight Outside Canteen A & Lee Wee Nam Library / Outside NIE']
,

    {'MacDonald’s': ['Halal','Non-Veg',2.00, 13.00,["MacDonald’s", "MacSpicy", "MacChicken","BigMac", "Fillet O Fish", "MacNuggests", "Fries", "Drinks"]]},


],

'Peach Garden Chinese Restaurant': 

['1100-2200'
,8
,'198,434'
,['Red Campus Rider/ Campus Weekend Rider, Bus 179, 179A alight Outside Canteen A & Lee Wee Nam Library / Opposite NIE OR Blue Campus Rider , Bus 199 alight Outside Canteen A & Lee Wee Nam Library / Outside NIE']
,

    {'Peach Garden Chinese Restaurant': ['Non-Halal','Non-Veg', 5.00, 50.00,["Steamed Buns", "Rice", "Chicken", "Carrot Cake", "Springrolls", "Fish", "Pork", "Drinks"]]}
],

'Pizza Hut Express': 

['1100-2000'
,9
,'198,434'
,['Red Campus Rider/ Campus Weekend Rider, Bus 179, 179A alight Outside Canteen A & Lee Wee Nam Library / Opposite NIE OR Blue Campus Rider , Bus 199 alight Outside Canteen A & Lee Wee Nam Library / Outside NIE']
,

    {'Pizza Hut Express': ['Halal','Non-Veg', 4.00, 30.00,["Pizza", "Pasta", "Rice", "Drinks"]]}
]



 }


foodlist = []
canteenlist = []

def time():
    timelist = []
    for a in List_dict.items():
        time_range = a[1][0].split('-')
        #print(time_range)
        timelist.append([a[0],time_range[0],time_range[1]])
    #print(timelist)
    timing = input("Enter a timing: ")
    if timing.isdigit():
        timing_int = int(timing)
        for x in timelist:
            if int(x[1]) <= timing_int <= int(x[2]):
                print(x[0], " is still open")
    else:
        print("Invalid timing")
    

for a in List_dict.items():
    canteenlist.append([a[0],(a[1][2])])
    for b in a[1]:
        try:
            for c in b.values():
                for d in c[4]:
                        e = d.upper()
                        foodlist.append([a[0],e])
        except:
            pass

#print (foodlist)
#print(canteenlist)



def routine_update():
    for a in List_dict.items():
        if [a[0],(a[1][2])] in canteenlist:
            pass
        else:
            canteenlist.append([a[0],(a[1][2])])
        for b in a[1]:
            try:
                for c in b.values():
                    for d in c[4]:
                            e = d.upper()
                            if [a[0],e] in foodlist:
                                pass
                            else:
                                foodlist.append([a[0],e])
            except:
                pass

def search_by_food(foodlist_canteens):
    foodsearch = input("What Food? ")
    if len(foodsearch)<2:
        print("Please type a word. And not a letter! Thank you.")
        return
    else:
        upper_foodsearch = foodsearch.upper()
        foodcheck = False
        foodplaces = []
        for x in foodlist:
            if upper_foodsearch in x[1]:
                foodcheck = True
                if x[0] in foodplaces:
                    pass
                else:
                    foodplaces.append(x[0])
        
    #print(foodcheck)
        if foodcheck:
            for x in foodplaces:
                for y in canteenlist:
                    if x == y[0]:
                        print("Found in: ",x, "at ", y[1],".")
            return
        else:
            print("Not found in any area.")
            return

def search_by_ranking():
    rankinglist =[]
    for a in List_dict.items():
        rankinglist.append([(a[1][1]),a[0]])
    rankinglist = ranking_sort(rankinglist)
    for x in rankinglist:
        print (x)

def ranking_sort(list):
    number_list = []
    new_list = []
    for x in list:
        number_list.append(x[0])
    number_list.sort()
    for x in number_list:
        for y in list:
            try:
                y.index(x)
                new_list.append(y)
            except:
                pass
    return new_list

def search_by_pricing():
    pricinglist = []
    for a in List_dict.items():
        for b in a[1]:
            try:
                for c in b.items():
                    stall_name = str(c[0])+" ("+str(a[0])+")"
                    pricinglist.append([c[1][2],c[1][3],stall_name])
            except:
                    pass
                
    target_price = input("Please input your targeted budget: ")
    print()
    stalls_found = []

    try:
        if float(target_price)<=0:
                print("Your budget cannot be a zero or negative!")
                return
        for a in pricinglist:
            if a[0]<float(target_price) <a[1]:
                price_range = str(a[0])+"~"+str(a[1])
                stalls_found.append([a[2],price_range])
        for a in stalls_found:
            print(a[0]," at ",a[1])
    except:
        print("Invalid. Please try again.")

    return

def add_location():
    location_name = new_string("New Location")
    location_coordinate_x = int(new_value("Coordinate X"))
    location_coordinate_y = int(new_value("Coordinate Y"))
    rankinglist = []
    for a in List_dict.items():
        rankinglist.append(a[1][1])
    while True:
        ranking = int(new_value("Ranking"))
        if ranking in rankinglist:
            print("That rank is taken! Please choose another!!")
            continue
        else:
            break
    opening_hours = new_string("Opening Hours")
    others = new_string("Other Information")
    List_dict[location_name] = [opening_hours,ranking,str(location_coordinate_x)+","+str(location_coordinate_y)]
    check_stalls = True
    while check_stalls:
        print()
        add_stalls = input("Add more stores? (Type '-1' to exit and must have at least 1 stall)")
        if add_stalls == "-1" and len(List_dict[location_name])>3:
            break
        else:
            new_stall(location_name)
    canteenlist.append([location_name,str(location_coordinate_x)+","+str(location_coordinate_y)])
    

def update_info():
    while True:
            routine_update()
            print()
            print("Update Information Interface")
            print("1.Add Food Location")
            print("2.Edit Existing Food Court")
            print("0.Return")
            selection_interface = input("Select by: ")
            if selection_interface == "0":
                break
                return
            elif selection_interface == "1":
                add_location()
            elif selection_interface == "2":
                counter = 1
                for x in canteenlist:                
                    print(counter,":",x[0])
                    counter+=1
                print("0 : Back")
                print()
                selection_interface = input("Select your Canteen: ")##Select Canteen
                if selection_interface == "0":
                    break
                    return
                elif selection_interface.isdigit():
                    if int(selection_interface) >= len(canteenlist)+1:
                        print("Out of range!")
                        break
                        return
                    else:
                        selected_canteen = canteenlist[int(selection_interface)-1][0]
                        print("Selected ",selected_canteen)
                    print()
                    while True:
                        print("Which stalls to change for",selected_canteen,"?")
                        ##Displaying stores
                        counter = 1
                        stalls = []
                        for a in List_dict.items():
                            if a[0] == selected_canteen:
                                for b in a[1]:
                                    
                                    try:
                                        for c in b.keys():
                                            print (counter,":",c)
                                            counter += 1
                                            stalls.append(c)
                                    except:
                                        pass
                        #print(stalls)
                        print(counter,": New store")
                        print("0 : Exit")
                        ##ask for input for stores
                        selection_interface = input("Choice: ")
                        if selection_interface == "0":
                            print("Returning...")
                            break
                        elif selection_interface == str(counter):
                            new_stall(selected_canteen)
                        elif selection_interface.isdigit and 0<int(selection_interface)<counter:
                            existing_stall(selected_canteen,selection_interface,stalls)

                else:
                    pass
            else:
                pass

def existing_stall(selected_canteen,selection_interface,stalls):
    selected_stall = stalls[int(selection_interface)-1]
    for a in List_dict.items():
                if a[0] == selected_canteen:
                                   for b in a[1]:
                                        try:
                                            if selected_stall in b:
                                                #print(b[selected_stall][4])
                                                b[selected_stall][4] = add_food(b[selected_stall][4],selected_stall)
                                        except:
                                            pass


def new_stall(selected_canteen):
    new_key = new_string("stall name")
    min_price = new_value("min price")
    max_price = new_value("max price")
    new_foods = add_food([],new_key)
    for a in List_dict.items():
        if a[0] == selected_canteen:
                a[1].append({new_key : ['Non-Halal',"Non-Veg",min_price,max_price,new_foods]})
                            
    print(new_key,"has",new_foods,"of within range",min_price,"to",max_price)


def new_string(text):
    while True:
        a = input("Input name for "+text+": ")
        return a

def new_value(number):
    while True:
        a = input("Input number for "+number+": ")
        if a.isdigit() and float(a)>0:
            return float(a)
        else:
            print("Invalid number. Try again.")
            continue

def add_food(current_food,stall_name):
    foodlist = current_food
    while True:
        print()
        print("Currently",stall_name,"have",foodlist)
        a = input("Do you still want to add food? (Type '-1' to stop)")
        if len(foodlist)==0 and a == "-1":
            print("You must have at least one food!")
            continue
        if a == "-1":
            return foodlist
        else:
            if a in foodlist:
                print("That is already in! You have already added it!")
                print()
                continue
            else:
                foodlist.append(a)



